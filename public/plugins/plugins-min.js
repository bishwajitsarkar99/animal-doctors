export function hoverGridPlugin(){return{id:"hoverGrid",beforeInit(e){e._prevHoverYIndex=-1,e._prevHoverXIndex=-1,e._hoverYTick=null,e._hoverXTick=null},afterEvent(e,t){const{event:i}=t,l=e.scales.y,o=e.scales.x;if(!i||!i.x&&!i.y||!l||!o)return;let r=-1,n=-1;const a=i.y,s=i.x;if(l.ticks.forEach((e,t)=>{const i=l.getPixelForTick(t);Math.abs(i-a)<10&&(r=t)}),o.ticks.forEach((e,t)=>{const i=o.getPixelForTick(t);Math.abs(i-s)<10&&(n=t)}),r===e._prevHoverYIndex&&n===e._prevHoverXIndex)return;e._prevHoverYIndex=r,e._prevHoverXIndex=n;const c=l.getTicks?.()??[],f=o.getTicks?.()??[];e._hoverYTick=c[r]?.value??null,e._hoverXTick=f[n]?.value??null,e.options.scales.y.grid.color=t=>void 0!==t?.tick?.value&&null!==e._hoverYTick&&t.tick.value===e._hoverYTick?"rgba(0,0,0,0)":"silver",e.options.scales.x.grid.color=t=>void 0!==t?.tick?.value&&null!==e._hoverXTick&&t.tick.value===e._hoverXTick?"rgba(0,0,0,0)":"silver",e.update()}}}export function dottedGridPlugin(){return{id:"dottedGrid",afterDraw(e){const t=e.scales.y,i=e.scales.x,l=e.ctx,o=e.chartArea,r=e._hoverYTick,n=e._hoverXTick;if(l.save(),l.fillStyle="#000000",void 0!==r){const e=t.getTicks().findIndex(e=>e.value===r);if(-1!==e){const i=t.getPixelForTick(e);for(let e=o.left;e<=o.right;e+=6)l.beginPath(),l.arc(e,i,.7,0,2*Math.PI),l.fill()}}if(void 0!==n){const e=i.getTicks().findIndex(e=>e.value===n);if(-1!==e){const t=i.getPixelForTick(e);for(let e=o.top;e<=o.bottom;e+=6)l.beginPath(),l.arc(t,e,.7,0,2*Math.PI),l.fill()}}l.restore()}}}export function axisTooltipTextPlugin(){return{id:"axisTooltipText",afterEvent(e,t){const i=t.event,{x:l,y:o}=i,r=e.chartArea,n=e.scales.x,a=e.scales.y;if(!(l>=r.left&&l<=r.right&&o>=r.top&&o<=r.bottom))return e._hoverXIndex=void 0,void(e._hoverYValue=void 0);let s,c=1/0;n.getTicks().forEach((e,t)=>{const i=n.getPixelForTick(t),o=Math.abs(i-l);o<c&&(c=o,s=t)}),e._hoverXIndex=s;let f,d=1/0;a.getTicks().forEach(e=>{const t=a.getPixelForValue(e.value),i=Math.abs(t-o);i<d&&(d=i,f=e.value)}),e._hoverYValue=f},afterDraw(e){const t=e.ctx,i=e.scales.x,l=e.scales.y,o=e.chartArea,r=e._hoverXIndex,n=e._hoverYValue;if(t.save(),t.font="11px Arial",t.textAlign="center",t.textBaseline="middle",void 0!==n){const e=l.getPixelForValue(n),i=n.toString(),r=5,a=t.measureText(i).width+2*r,s=18;t.fillStyle="#000",t.strokeStyle="#888",t.lineWidth=1,t.beginPath(),t.rect(o.left-a-8,e-s/2,a,s),t.fill(),t.stroke(),t.fillStyle="#fff",t.fillText(i,o.left-a/2-8,e)}if(void 0!==r){const l=i.getPixelForTick(r),n=(e.data.labels[r]||"").toString(),a=5,s=t.measureText(n).width+2*a,c=18;t.fillStyle="#000",t.strokeStyle="#888",t.lineWidth=1,t.beginPath(),t.rect(l-s/2,o.bottom+8,s,c),t.fill(),t.stroke(),t.fillStyle="#fff",t.fillText(n,l,o.bottom+c/2+8)}t.restore()}}}export function axisTooltipDayFormatePlugin(){return{id:"axisTooltipDay",afterEvent(e,t){const i=t.event,{x:l,y:o}=i,r=e.chartArea;l>=r.left&&l<=r.right&&o>=r.top&&o<=r.bottom||(e._hoverXTick=void 0,e._hoverYTick=void 0)},afterDraw(e){const t=e.ctx,i=e.scales.x,l=e.scales.y,o=e.chartArea,r=e._hoverXTick,n=e._hoverYTick;if(t.save(),t.font="11px Arial",t.fillStyle="#fff",t.textAlign="center",t.textBaseline="middle",void 0!==n){const e=l.getTicks().findIndex(e=>e.value===n);if(-1!==e){const i=l.getPixelForTick(e),r=n.toString(),a=t.measureText(r).width+10,s=18;t.fillStyle="black",t.strokeStyle="#888",t.lineWidth=1,t.beginPath(),t.roundRect(o.left-a-8,i-s/2,a,s,1),t.fill(),t.stroke(),t.fillStyle="#fff",t.fillText(r,o.left-a/2-8,i)}}if(void 0!==r){const l=i.getTicks().findIndex(e=>e.value===r);if(-1!==l){const n=i.getPixelForTick(l);let a=e.data.labels[r],s=a;if(a){const e=new Date(a);isNaN(e)||(s=e.toLocaleDateString("en-US",{weekday:"short"}))}const c=t.measureText(s).width+10,f=18;t.fillStyle="black",t.strokeStyle="#888",t.lineWidth=1,t.beginPath(),t.roundRect(n-c/2,o.bottom+8,c,f,1),t.fill(),t.stroke(),t.fillStyle="#fff",t.fillText(s,n,o.bottom+f/2+8)}}t.restore()}}}export function axisTooltipDateFormatePlugin(){return{id:"axisTooltipDate",afterEvent(e,t){const i=t.event,{x:l,y:o}=i,r=e.chartArea;l>=r.left&&l<=r.right&&o>=r.top&&o<=r.bottom||(e._hoverXTick=void 0,e._hoverYTick=void 0)},afterDraw(e){const t=e.ctx,i=e.scales.x,l=e.scales.y,o=e.chartArea,r=e._hoverXTick,n=e._hoverYTick;if(t.save(),t.font="11px Arial",t.fillStyle="#fff",t.textAlign="center",t.textBaseline="middle",void 0!==n){const e=l.getTicks().findIndex(e=>e.value===n);if(-1!==e){const i=l.getPixelForTick(e),r=n.toString(),a=t.measureText(r).width+10,s=18;t.fillStyle="black",t.strokeStyle="#888",t.lineWidth=1,t.beginPath(),t.roundRect(o.left-a-8,i-s/2,a,s,1),t.fill(),t.stroke(),t.fillStyle="#fff",t.fillText(r,o.left-a/2-8,i)}}if(void 0!==r){const l=i.getTicks().findIndex(e=>e.value===r);if(-1!==l){const n=i.getPixelForTick(l);let a=e.data.labels[r],s=a;if(a){const e=new Date(a);isNaN(e)||(s=`${String(e.getDate()).padStart(2,"0")}-${e.toLocaleString("default",{month:"short"})}-${e.getFullYear()}`)}const c=t.measureText(s).width+10,f=18;t.fillStyle="black",t.strokeStyle="#888",t.lineWidth=1,t.beginPath(),t.roundRect(n-c/2,o.bottom+8,c,f,1),t.fill(),t.stroke(),t.fillStyle="#fff",t.fillText(s,n,o.bottom+f/2+8)}}t.restore()}}}export function axisTooltipMonthFormatePlugin(){return{id:"axisTooltipMonth",afterEvent(e,t){const i=t.event,{x:l,y:o}=i,r=e.chartArea;l>=r.left&&l<=r.right&&o>=r.top&&o<=r.bottom||(e._hoverXTick=void 0,e._hoverYTick=void 0)},afterDraw(e){const t=e.ctx,i=e.scales.x,l=e.scales.y,o=e.chartArea,r=e._hoverXTick,n=e._hoverYTick;if(t.save(),t.font="11px Arial",t.fillStyle="#fff",t.textAlign="center",t.textBaseline="middle",void 0!==n){const e=l.getTicks().findIndex(e=>e.value===n);if(-1!==e){const i=l.getPixelForTick(e),r=n.toString(),a=t.measureText(r).width+10,s=18;t.fillStyle="black",t.strokeStyle="#888",t.lineWidth=1,t.beginPath(),t.roundRect(o.left-a-8,i-s/2,a,s,1),t.fill(),t.stroke(),t.fillStyle="#fff",t.fillText(r,o.left-a/2-8,i)}}if(void 0!==r){const l=i.getTicks().findIndex(e=>e.value===r);if(-1!==l){const n=i.getPixelForTick(l);let a=e.data.labels[r],s=a;if(a){const e=new Date(a);isNaN(e)||(s=`${e.toLocaleString("default",{month:"short"})}`)}const c=t.measureText(s).width+10,f=18;t.fillStyle="black",t.strokeStyle="#888",t.lineWidth=1,t.beginPath(),t.roundRect(n-c/2,o.bottom+8,c,f,1),t.fill(),t.stroke(),t.fillStyle="#fff",t.fillText(s,n,o.bottom+f/2+8)}}t.restore()}}}export function axisTooltipYearFormatePlugin(){return{id:"axisTooltipYear",afterEvent(e,t){const i=t.event,{x:l,y:o}=i,r=e.chartArea;l>=r.left&&l<=r.right&&o>=r.top&&o<=r.bottom||(e._hoverXTick=void 0,e._hoverYTick=void 0)},afterDraw(e){const t=e.ctx,i=e.scales.x,l=e.scales.y,o=e.chartArea,r=e._hoverXTick,n=e._hoverYTick;if(t.save(),t.font="11px Arial",t.fillStyle="#fff",t.textAlign="center",t.textBaseline="middle",void 0!==n){const e=l.getTicks().findIndex(e=>e.value===n);if(-1!==e){const i=l.getPixelForTick(e),r=n.toString(),a=t.measureText(r).width+10,s=18;t.fillStyle="black",t.strokeStyle="#888",t.lineWidth=1,t.beginPath(),t.roundRect(o.left-a-8,i-s/2,a,s,1),t.fill(),t.stroke(),t.fillStyle="#fff",t.fillText(r,o.left-a/2-8,i)}}if(void 0!==r){const l=i.getTicks().findIndex(e=>e.value===r);if(-1!==l){const n=i.getPixelForTick(l);let a=e.data.labels[r],s=a;if(a){const e=new Date(a);isNaN(e)||(s=`${e.toLocaleString("default",{month:"short"})} ${e.getFullYear()}`)}const c=t.measureText(s).width+10,f=18;t.fillStyle="black",t.strokeStyle="#888",t.lineWidth=1,t.beginPath(),t.roundRect(n-c/2,o.bottom+8,c,f,1),t.fill(),t.stroke(),t.fillStyle="#fff",t.fillText(s,n,o.bottom+f/2+8)}}t.restore()}}}export function axisCursorPlugin(){return{id:"axisCursor",afterEvent(e,t){const{event:i}=t,l=e.scales.x,o=e.scales.y,r=e.chartArea,n=i.x,a=i.y;let s=!1,c=!1;l.ticks.forEach((e,t)=>{const i=l.getPixelForTick(t);Math.abs(n-i)<6&&a>=r.top&&a<=r.bottom&&(s=!0)}),o.ticks.forEach((e,t)=>{const i=o.getPixelForTick(t);Math.abs(a-i)<6&&n>=r.left&&n<=r.right&&(c=!0)}),e.canvas.style.cursor=s||c?"move":"default"}}}export function legendCursorPlugin(){return{id:"legendCursor",afterEvent(e,t){const i=t.event,l=e.canvas,o=e.legend;if(!(i&&o&&o._hitBoxes&&o.legendItems))return;const r=i.x,n=i.y;let a=!1;for(let e=0;e<o._hitBoxes.length;e++){const t=o._hitBoxes[e];if(r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height){a=!0;break}}l.style.cursor=a?"pointer":"default"}}}export function ChartScrollPlugin(){return{id:"ChartScrollPlugin",afterInit(e){e.canvas.addEventListener("wheel",t=>{t.preventDefault();const i=e.scales.x,l=.1*(i.max-i.min);t.deltaY<0?(i.options.min-=l,i.options.max-=l):(i.options.min+=l,i.options.max+=l),e.update()})}}}